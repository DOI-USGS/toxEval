<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot EAR heat maps — plot_tox_heatmap • toxEval</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot EAR heat maps — plot_tox_heatmap" />
<meta property="og:description" content="The plot_tox_heatmap function creates a heat (tile) map with sites on the x-axis, 
a specified grouping on the y-axis (defined by the category argument), and color shading 
defining the mean or maximum EAR. See &quot;Summarizing the data&quot; in the Introduction vignette:  
vignette(&quot;Introduction&quot;, package = &quot;toxEval&quot;) for a description on how the 
EAR values are computed, aggregated, and summarized. The y-axis grouping can be &quot;Biological&quot;,
&quot;Chemical Class&quot;, or &quot;Chemical&quot;. When specifying the &quot;Chemical&quot; option, a secondary y-axis 
is automatically included to group chemicals into chemical class. The function computes 
default breaks for the color scale to match the spread of the data, but breaks can also 
be customized with the breaks argument.
This is a function where it may be ideal to create a custom order to the sites 
(for example, west-to-east). See the above section &quot;Custom configuration&quot;
vignette(&quot;Introduction&quot;, package = &quot;toxEval&quot;) for instructions on how to convert 
the character vector sites to a factor with ordered levels." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">toxEval</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Introduction.html">Background</a>
</li>
<li>
  <a href="../articles/basicWorkflow.html">Basic Workflow</a>
</li>
<li>
  <a href="../reference/index.html">Function Help</a>
</li>
<li>
  <a href="../articles/PrepareData.html">Data Preparation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shinyApp.html">Shiny App</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Exploring Benchmarks</a>
    </li>
    <li>
      <a href="../articles/pivot.html">Prepare Data in R</a>
    </li>
    <li>
      <a href="../articles/does_curves.html">Dose Response Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/bibliography.html">Bibliograpy</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/toxEval">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot EAR heat maps</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/toxEval/blob/master/R/plot_heat_chemical.R'><code>R/plot_heat_chemical.R</code></a></small>
    <div class="hidden name"><code>plot_tox_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>plot_tox_heatmap</code> function creates a heat (tile) map with sites on the x-axis, 
a specified grouping on the y-axis (defined by the category argument), and color shading 
defining the mean or maximum EAR. See "Summarizing the data" in the Introduction vignette:  
<a href='../doc/Introduction.html#summarize_data'><code><a href='../articles/Introduction.html'>vignette("Introduction", package = "toxEval")</a></code></a> for a description on how the 
EAR values are computed, aggregated, and summarized. The y-axis grouping can be "Biological",
"Chemical Class", or "Chemical". When specifying the "Chemical" option, a secondary y-axis 
is automatically included to group chemicals into chemical class. The function computes 
default breaks for the color scale to match the spread of the data, but breaks can also 
be customized with the breaks argument.
This is a function where it may be ideal to create a custom order to the sites 
(for example, west-to-east). See the above section "Custom configuration"
<a href='../doc/Introduction.html#custom_config'><code><a href='../articles/Introduction.html'>vignette("Introduction", package = "toxEval")</a></code></a> for instructions on how to convert 
the character vector sites to a factor with ordered levels.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_tox_heatmap</span>(
  <span class='no'>chemical_summary</span>,
  <span class='no'>chem_site</span>,
  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Biological"</span>,
  <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1e-05</span>, <span class='fl'>1e-04</span>, <span class='fl'>0.001</span>, <span class='fl'>0.01</span>, <span class='fl'>0.1</span>, <span class='fl'>1</span>, <span class='fl'>10</span>),
  <span class='kw'>manual_remove</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mean_logic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sum_logic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>plot_ND</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>font_size</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>title</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>legend_lab</span> <span class='kw'>=</span> <span class='fl'>NA</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chemical_summary</th>
      <td><p>Data frame from <code><a href='get_chemical_summary.html'>get_chemical_summary</a></code>.</p></td>
    </tr>
    <tr>
      <th>chem_site</th>
      <td><p>Data frame with columns SiteID, site_grouping, and Short Name.</p></td>
    </tr>
    <tr>
      <th>category</th>
      <td><p>Either "Biological", "Chemical Class", or "Chemical".</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Numerical vector to define data bins and legend breaks.</p></td>
    </tr>
    <tr>
      <th>manual_remove</th>
      <td><p>Vector of categories to remove.</p></td>
    </tr>
    <tr>
      <th>mean_logic</th>
      <td><p>Logical.  <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p></td>
    </tr>
    <tr>
      <th>sum_logic</th>
      <td><p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p></td>
    </tr>
    <tr>
      <th>plot_ND</th>
      <td><p>Logical. Whether or not to plot "Biological" groupings,
"Chemical Class" groupings, or "Chemical" that do not have any detections.</p></td>
    </tr>
    <tr>
      <th>font_size</th>
      <td><p>Numeric value to adjust the axis font size.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>Character title for plot.</p></td>
    </tr>
    <tr>
      <th>legend_lab</th>
      <td><p>Character label for legend. Default is NA which produces an automatic label.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If there are site/parameters (chemical/chemical class/biological grouping) combinations that
don't have data, those areas are represented by an "X". If there are 0 values,
they are considered "non-detects", and represented with a distinct color.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>path_to_tox</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"toxEval"</span>)
<span class='no'>file_name</span> <span class='kw'>&lt;-</span> <span class='st'>"OWC_data_fromSup.xlsx"</span>
<span class='no'>full_path</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>path_to_tox</span>, <span class='no'>file_name</span>)

<span class='no'>tox_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_toxEval.html'>create_toxEval</a></span>(<span class='no'>full_path</span>)

<span class='no'>ACC</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_ACC.html'>get_ACC</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_info</span>$<span class='no'>CAS</span>)
<span class='no'>ACC</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='remove_flags.html'>remove_flags</a></span>(<span class='no'>ACC</span>)

<span class='no'>cleaned_ep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='clean_endPoint_info.html'>clean_endPoint_info</a></span>(<span class='no'>end_point_info</span>)
<span class='no'>filtered_ep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='filter_groups.html'>filter_groups</a></span>(<span class='no'>cleaned_ep</span>)

<span class='no'>chemical_summary</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_chemical_summary.html'>get_chemical_summary</a></span>(<span class='no'>tox_list</span>, <span class='no'>ACC</span>, <span class='no'>filtered_ep</span>)

<span class='co'>#Order the site_groupings:</span>
<span class='no'>tox_list</span>$<span class='no'>chem_site</span>$<span class='no'>site_grouping</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_site</span>$<span class='no'>site_grouping</span>,
              <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Lake Superior"</span>,
              <span class='st'>"Lake Michigan"</span>,
              <span class='st'>"Lake Huron"</span>,
              <span class='st'>"Lake Erie"</span>,
              <span class='st'>"Lake Ontario"</span>))

<span class='co'>#Order sites:</span>
<span class='no'>sitesOrdered</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"StLouis"</span>,<span class='st'>"Nemadji"</span>,<span class='st'>"WhiteWI"</span>,<span class='st'>"Bad"</span>,<span class='st'>"Montreal"</span>,
<span class='st'>"PresqueIsle"</span>,<span class='st'>"Ontonagon"</span>,<span class='st'>"Sturgeon"</span>,<span class='st'>"Tahquamenon"</span>,<span class='st'>"Burns"</span>,
<span class='st'>"IndianaHC"</span>,<span class='st'>"StJoseph"</span>,<span class='st'>"PawPaw"</span>,<span class='st'>"Kalamazoo"</span>,<span class='st'>"GrandMI"</span>,
<span class='st'>"Milwaukee"</span>,<span class='st'>"Muskegon"</span>,<span class='st'>"WhiteMI"</span>,<span class='st'>"PereMarquette"</span>,<span class='st'>"Manitowoc"</span>,
<span class='st'>"Manistee"</span>,<span class='st'>"Fox"</span>,<span class='st'>"Oconto"</span>,<span class='st'>"Peshtigo"</span>,<span class='st'>"Menominee"</span>,
<span class='st'>"Indian"</span>,<span class='st'>"Cheboygan"</span>,<span class='st'>"Ford"</span>,<span class='st'>"Escanaba"</span>,<span class='st'>"Manistique"</span>,
<span class='st'>"ThunderBay"</span>,<span class='st'>"AuSable"</span>,<span class='st'>"Rifle"</span>,<span class='st'>"Saginaw"</span>,<span class='st'>"BlackMI"</span>,
<span class='st'>"Clinton"</span>,<span class='st'>"Rouge"</span>,<span class='st'>"HuronMI"</span>,<span class='st'>"Raisin"</span>,<span class='st'>"Maumee"</span>,
<span class='st'>"Portage"</span>,<span class='st'>"Sandusky"</span>,<span class='st'>"HuronOH"</span>,<span class='st'>"Vermilion"</span>,<span class='st'>"BlackOH"</span>,
<span class='st'>"Rocky"</span>,<span class='st'>"Cuyahoga"</span>,<span class='st'>"GrandOH"</span>,<span class='st'>"Cattaraugus"</span>,<span class='st'>"Tonawanda"</span>,
<span class='st'>"Genesee"</span>,<span class='st'>"Oswego"</span>,<span class='st'>"BlackNY"</span>,<span class='st'>"Oswegatchie"</span>,<span class='st'>"Grass"</span>,
<span class='st'>"Raquette"</span>,<span class='st'>"StRegis"</span>)

<span class='no'>tox_list</span>$<span class='no'>chem_site</span>$<span class='no'>`Short Name`</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_site</span>$<span class='no'>`Short Name`</span>,
              <span class='kw'>levels</span> <span class='kw'>=</span> <span class='no'>sitesOrdered</span>)
<span class='fu'>plot_tox_heatmap</span>(<span class='no'>chemical_summary</span>, <span class='no'>tox_list</span>$<span class='no'>chem_site</span>, <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical Class"</span>)</div><div class='img'><img src='plot_tox_heatmap-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_tox_heatmap</span>(<span class='no'>chemical_summary</span>, <span class='no'>tox_list</span>$<span class='no'>chem_site</span>,
                 <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical"</span>, <span class='kw'>legend_lab</span> <span class='kw'>=</span> <span class='st'>"EAR"</span>)</div><div class='img'><img src='plot_tox_heatmap-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>single_site</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>chemical_summary</span>, <span class='no'>site</span> <span class='kw'>==</span> <span class='st'>"USGS-04024000"</span>)
<span class='fu'>plot_tox_heatmap</span>(<span class='kw'>chemical_summary</span> <span class='kw'>=</span> <span class='no'>single_site</span>,
                 <span class='kw'>chem_site</span> <span class='kw'>=</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_site</span>, <span class='no'>SiteID</span> <span class='kw'>==</span> <span class='st'>"USGS-04024000"</span>),
                 <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical Class"</span>)</div><div class='img'><img src='plot_tox_heatmap-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_tox_heatmap</span>(<span class='kw'>chemical_summary</span> <span class='kw'>=</span> <span class='no'>single_site</span>,
                 <span class='kw'>chem_site</span> <span class='kw'>=</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_site</span>, <span class='no'>SiteID</span> <span class='kw'>==</span> <span class='st'>"USGS-04024000"</span>),
                 <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical"</span>)</div><div class='img'><img src='plot_tox_heatmap-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laura DeCicco, Steven Corsi, Daniel Villeneuve, Brett Blackwell, Gerald Ankley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


