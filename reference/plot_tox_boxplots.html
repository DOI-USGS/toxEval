<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Grouped Boxplots — plot_chemical_boxplots • toxEval</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Grouped Boxplots — plot_chemical_boxplots" />
<meta property="og:description" content="The plot_tox_boxplots function creates a set of boxplots representing EAR 
values computed with the get_chemical_summary function, and 
dependent on the choice of several input options. See &quot;Summarizing the data&quot; 
in the Introduction vignette: vignette(&quot;Introduction&quot;, package = &quot;toxEval&quot;). 
for a description of how the EAR values are computed, aggregated,
and summarized. Choosing &quot;Chemical Class&quot; in the category argument 
will generate separate boxplots for each unique class. &quot;Chemical&quot; will generate 
boxplots for each individual chemical, and &quot;Biological&quot; will generate boxplots 
for each group in the selected ToxCast annotation." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">toxEval</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Introduction.html">Background</a>
</li>
<li>
  <a href="../articles/basicWorkflow.html">Basic Workflow</a>
</li>
<li>
  <a href="../reference/index.html">Function Help</a>
</li>
<li>
  <a href="../articles/PrepareData.html">Data Preparation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shinyApp.html">Shiny App</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Exploring Benchmarks</a>
    </li>
    <li>
      <a href="../articles/pivot.html">Prepare Data in R</a>
    </li>
    <li>
      <a href="../articles/does_curves.html">Dose Response Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/bibliography.html">Bibliograpy</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/USGS-R/toxEval">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Grouped Boxplots</h1>
    <small class="dont-index">Source: <a href='https://github.com/USGS-R/toxEval/blob/master/R/plot_chemical_boxplots.R'><code>R/plot_chemical_boxplots.R</code></a>, <a href='https://github.com/USGS-R/toxEval/blob/master/R/plot_group_boxplots.R'><code>R/plot_group_boxplots.R</code></a></small>
    <div class="hidden name"><code>plot_tox_boxplots.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>plot_tox_boxplots</code> function creates a set of boxplots representing EAR 
values computed with the <code><a href='get_chemical_summary.html'>get_chemical_summary</a></code> function, and 
dependent on the choice of several input options. See "Summarizing the data" 
in the Introduction vignette: <a href='../doc/Introduction.html#summarize_data'><code><a href='../articles/Introduction.html'>vignette("Introduction", package = "toxEval")</a></code></a>. 
for a description of how the EAR values are computed, aggregated,
and summarized. Choosing "Chemical Class" in the category argument 
will generate separate boxplots for each unique class. "Chemical" will generate 
boxplots for each individual chemical, and "Biological" will generate boxplots 
for each group in the selected ToxCast annotation.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_chemical_boxplots</span>(
  <span class='no'>chemical_summary</span>,
  <span class='no'>...</span>,
  <span class='kw'>manual_remove</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mean_logic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sum_logic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>plot_ND</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>font_size</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>title</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>x_label</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>hit_threshold</span> <span class='kw'>=</span> <span class='fl'>NA</span>
)

<span class='fu'>plot_tox_boxplots</span>(
  <span class='no'>chemical_summary</span>,
  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Biological"</span>,
  <span class='kw'>manual_remove</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mean_logic</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sum_logic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>plot_ND</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>font_size</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>title</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>x_label</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>hit_threshold</span> <span class='kw'>=</span> <span class='fl'>NA</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chemical_summary</th>
      <td><p>Data frame from <code><a href='get_chemical_summary.html'>get_chemical_summary</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional group_by arguments. This can be handy for creating facet graphs.</p></td>
    </tr>
    <tr>
      <th>manual_remove</th>
      <td><p>Vector of categories to remove.</p></td>
    </tr>
    <tr>
      <th>mean_logic</th>
      <td><p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p></td>
    </tr>
    <tr>
      <th>sum_logic</th>
      <td><p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p></td>
    </tr>
    <tr>
      <th>plot_ND</th>
      <td><p>Logical. Whether or not to plot "Biological" groupings,
"Chemical Class" groupings, or "Chemical" that do not have any detections.</p></td>
    </tr>
    <tr>
      <th>font_size</th>
      <td><p>Numeric value to adjust the axis font size.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>Character title for plot. Default is NA which produces no title.</p></td>
    </tr>
    <tr>
      <th>x_label</th>
      <td><p>Character for x label. Default is NA which produces an automatic label.</p></td>
    </tr>
    <tr>
      <th>palette</th>
      <td><p>Vector of color palette for boxplot fill. Can be a named vector
to specify specific colors for specific categories.</p></td>
    </tr>
    <tr>
      <th>hit_threshold</th>
      <td><p>Numeric threshold defining a "hit".</p></td>
    </tr>
    <tr>
      <th>category</th>
      <td><p>Character. Either "Biological", "Chemical Class", or "Chemical".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It is also possible to display a threshold line using the hit_threshold argument. 
The graph will then include the number of sites with detections, the threshold 
line, and the number of "hits" indicating how many sites that have EAR values 
exceeding the hit_threshold.</p>
<p>The graph shows a slightly different result for a single site. For a single 
site graph, the number of chemicals that were detected and have associated endpoint 
ACCs represented are displayed.</p>
<p>The functions <code>plot_tox_boxplots</code> and <code>graph_chem_data</code> are functions that perform
the statistical calculations to create the plot. <code>graph_chem_data</code> is specific
to the "Chemical" plot, and <code>plot_tox_boxplots</code> is for "Biological" and 
"Chemical Class".</p>
<p>Box plots are standard Tukey representations. See "Box plot details" in the Basic Workflow vignette: 
<a href='../doc/basicWorkflow.html#box_plot_details'><code><a href='../articles/basicWorkflow.html'>vignette("basicWorkflow", package = "toxEval")</a></code></a>
for more information.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># This is the example workflow:</span>
<span class='no'>path_to_tox</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"toxEval"</span>)
<span class='no'>file_name</span> <span class='kw'>&lt;-</span> <span class='st'>"OWC_data_fromSup.xlsx"</span>

<span class='no'>full_path</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>path_to_tox</span>, <span class='no'>file_name</span>)

<span class='no'>tox_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_toxEval.html'>create_toxEval</a></span>(<span class='no'>full_path</span>)
<span class='no'>ACC</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_ACC.html'>get_ACC</a></span>(<span class='no'>tox_list</span>$<span class='no'>chem_info</span>$<span class='no'>CAS</span>)
<span class='no'>ACC</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='remove_flags.html'>remove_flags</a></span>(<span class='no'>ACC</span>)

<span class='no'>cleaned_ep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='clean_endPoint_info.html'>clean_endPoint_info</a></span>(<span class='no'>end_point_info</span>)
<span class='no'>filtered_ep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='filter_groups.html'>filter_groups</a></span>(<span class='no'>cleaned_ep</span>)
<span class='no'>chemical_summary</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='get_chemical_summary.html'>get_chemical_summary</a></span>(<span class='no'>tox_list</span>, <span class='no'>ACC</span>, <span class='no'>filtered_ep</span>)
<span class='fu'>plot_tox_boxplots</span>(<span class='no'>chemical_summary</span>, <span class='st'>"Biological"</span>)</div><div class='img'><img src='plot_tox_boxplots-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_tox_boxplots</span>(<span class='no'>chemical_summary</span>, <span class='st'>"Chemical Class"</span>)</div><div class='img'><img src='plot_tox_boxplots-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_tox_boxplots</span>(<span class='no'>chemical_summary</span>, <span class='st'>"Chemical"</span>)</div><div class='img'><img src='plot_tox_boxplots-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='no'>cbPalette</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"#999999"</span>, <span class='st'>"#E69F00"</span>, <span class='st'>"#56B4E9"</span>, <span class='st'>"#009E73"</span>, <span class='st'>"#F0E442"</span>,
               <span class='st'>"#0072B2"</span>, <span class='st'>"#D55E00"</span>, <span class='st'>"#CC79A7"</span>)
<span class='no'>graphData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='graph_data_prep.html'>tox_boxplot_data</a></span>(<span class='kw'>chemical_summary</span> <span class='kw'>=</span> <span class='no'>chemical_summary</span>,
                              <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Biological"</span>)
<span class='no'>cbValues</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span>(<span class='no'>cbPalette</span>)(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span>(<span class='no'>graphData</span>$<span class='no'>category</span>)))
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cbValues</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span>(<span class='no'>graphData</span>$<span class='no'>category</span>)

<span class='fu'>plot_tox_boxplots</span>(<span class='no'>chemical_summary</span>,
                  <span class='kw'>hit_threshold</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Biological"</span>,
                  <span class='kw'>palette</span> <span class='kw'>=</span> <span class='no'>cbValues</span>,
                  <span class='kw'>title</span> <span class='kw'>=</span> <span class='st'>'Maximum EAR per site, grouped by biological activity groupings'</span>)</div><div class='img'><img src='plot_tox_boxplots-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># \donttest{</span>
<span class='fu'>plot_tox_boxplots</span>(<span class='no'>chemical_summary</span>,
                  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical"</span>, <span class='kw'>x_label</span> <span class='kw'>=</span> <span class='st'>"EAR"</span>)</div><div class='img'><img src='plot_tox_boxplots-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>single_site</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>chemical_summary</span>, <span class='no'>site</span> <span class='kw'>==</span> <span class='st'>"USGS-04024000"</span>)
<span class='fu'>plot_tox_boxplots</span>(<span class='no'>single_site</span>,
                  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Biological"</span>)</div><div class='img'><img src='plot_tox_boxplots-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_tox_boxplots</span>(<span class='no'>single_site</span>,
                  <span class='kw'>category</span> <span class='kw'>=</span> <span class='st'>"Chemical"</span>, <span class='kw'>hit_threshold</span> <span class='kw'>=</span> <span class='fl'>0.001</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in continuous y-axis</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in continuous y-axis</span></div><div class='img'><img src='plot_tox_boxplots-7.png' alt='' width='700' height='433' /></div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laura DeCicco, Steven Corsi, Daniel Villeneuve, Brett Blackwell, Gerald Ankley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


