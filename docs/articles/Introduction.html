<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to toxEval • toxEval</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to toxEval">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">toxEval</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basicWorkflow.html">Basic Workflow</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to toxEval</a>
    </li>
    <li>
      <a href="../articles/PrepareData.html">Preparing toxEval Data</a>
    </li>
    <li>
      <a href="../articles/shinyApp.html">Shiny App</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to toxEval</h1>
            
            <h4 class="date">05 September, 2018</h4>
      
      
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>toxEval</code> R-package includes a set of functions to analyze, visualize, and organize measured concentration data as it relates to <a href="https://www.epa.gov/chemical-research/toxicity-forecasting">ToxCast dat</a> (default) or other user-selected chemical-biological interaction benchmark data such as water quality criteria. The intent of these analyses is to develop a better understanding of the potential biological relevance of environmental chemistry data. Results can be used to prioritize which chemicals at which sites may be of greatest concern. These methods are meant to be used as a screening technique to predict potential for biological influence from chemicals that ultimately need to be validated with direct biological assays.</p>
<p>The functions within this package allow great flexibly for exploring the potential biological affects of measured chemicals. Also included in the package is a browser-based application made from the <code>Shiny</code> R-package (the app). The app is based on functions within the R-package and includes many convenient analyses and visualization options for users to choose. Use of the functions within the R-package allows for additional flexibility within the functions beyond what the app offers and provides options for the user to interact more directly with the data. The overview in this document focuses on the R-package. Documentation for the app is provided in the <a href="shinyApp.html">ShinyApp vignette</a>.</p>
<p>This vignette provides a general overview of the concepts within <code>toxEval</code>, definitions of common terminology used throughout the package, and links to information to help understand fundamentals of the ToxCast database used within <code>toxEval</code>. In addition, instructions are provided for installing and updating the package from the Geological Survey R Archive Network (GRAN).</p>
<div id="what-is-toxcast" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-toxcast" class="anchor"></a>What is ToxCast?</h2>
<p>The U.S. EPA’s Toxicity Forecaster <a href="https://www.epa.gov/chemical-research/toxicity-forecasting" target="_blank">ToxCast</a> includes a database of chemical-biological interactions that contains information from hundreds of assays on thousands of chemicals, providing a means to assess biological relevance to measured concentrations. The <code>toxEval</code> package attempts to simplify the workflow for exploring data as it relates to these assay endpoints (benchmark data). The workflow uses ToxCast as a default for evaluation of chemical:biological interactions, but the user may also define alternative benchmarks for a custom or more traditional approach to biological relevance evaluation. This is also a useful capability for efficient comparison of ToxCast evaluation results with those from other toxicity benchmark databases.</p>
<p>When using the ToxCast endPoints for analysis, it is important to have at least a minimal understanding of what ToxCast data is, and which ToxCast data is relevant to any given study. There are many useful resources <a href="https://www.epa.gov/chemical-research/toxicity-forecasting" target="_blank">here</a>. There is also a tool called the <a href="https://actor.epa.gov/dashboard/" target="_blank">ToxCast Dashboard</a> that has a wealth of information on ToxCast data.</p>
<p>So what are we doing with the user input data and ToxCast? First, we calculate an Exposure-Activity Ratio (EAR) for each measurement. Then we can explore the EARs based on a wide variety of groupings to view the data in many dimensions.</p>
</div>
<div id="exposure-activity-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#exposure-activity-ratio" class="anchor"></a>Exposure-Activity Ratio</h2>
<p>An Exposure-Activity Ratio (EAR) is defined as the ratio of a measured concentration and a concentration that was determined to cause some activity in a specified ToxCast assay (“endPoint” concentration). An EAR &gt; 1.0 would indicate that the measured concentration is greater than the endpoint concentration. The ToxCast database (as provided in the current version of <code>toxEval</code>) provides as many as several hundred endPoints for more than 7000 chemicals. Each endPoint is a single test that was done to detect some form of biological activity.</p>
<p>In order to get appropriate EAR results, it is important to use the correct units. The <code>toxEval</code> package assumes all measured concentrations are reported in micrograms per liter (<span class="math inline">\(\mu\)</span>g/L). ToxCast data is reported in log(<span class="math inline">\(\mu\)</span>M), so the <code>toxEval</code> package automatically performs the unit conversion.</p>
<p>A secondary option within <code>toxEval</code> is for the user to provide a set of “benchmark concentrations” to define custom biological responses to meet specific study objectives (e.g. water quality criteria). In this case, EAR values are replaced with toxicity quotients. Similar to EAR values, toxicity quotients are defined as the ratio of a measured concentration to the benchmark concentration.</p>
<p>EAR is basically synonymous with bioanalytical equivalent concentrations (BEQ). EAR is a ratio, and BEQ is a measure of concentration, but both convey the same information.</p>
</div>
<div id="what-is-an-endpoint" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-an-endpoint" class="anchor"></a>What is an “endPoint”?</h2>
<p>ToxCast uses high-throughput assays to create concentration-response curves for each of these chemical:endPoint combinations. An endPoint is “associated with the perturbation of specific biological processes identified for the confirmation or monitoring of predicted site-specific hazards” <a href="https://doi.org/10.1021/acs.est.7b01613" target="_blank">Blackwell 2017</a>. That means a specific biological action was tested, and the concentration at which activity was observed was determined. Of several endpoint values provided within the ToxCast database, the activity concentration at cutoff (ACC) was chosen to compute EAR values within the <code>toxEval</code> package, consistent with the description in <a href="https://doi.org/10.1021/acs.est.7b01613" target="_blank">Blackwell, 2017</a>. ACC values from the ToxCast database are provided within the <code>toxEval</code> package.</p>
</div>
<div id="what-is-a-group" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-a-group" class="anchor"></a>What is a “group”?</h2>
<p>Often, it is valuable to consider aggregations of single endPoints in evaluation efforts. ToxCast has provided tables that group individual endPoints into generalized categories for functional use. The grouping summary table is included in <code>toxEval</code> and can be explored via the <code>end_point_info</code> data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(toxEval)
end_point_info &lt;-<span class="st"> </span>end_point_info</code></pre></div>
<p>See the help file <code><a href="../reference/end_point_info.html">?end_point_info</a></code> for specifics on how the table was downloaded.</p>
<p>Throughout the <code>toxEval</code> analysis, there are graphing and table functions that will summarize EARs based on either “Biological” groupings (as defined by a group of endPoints) or “Chemical Class” groupings (as defined by a group of chemicals).</p>
<p>The default grouping of ToxCast endPoints is “intended_target_family”, but depending on the analysis, it may be more appropriate to use other grouping categories. To change the default, specify a grouping in the <code>groupCol</code> argument of the <code>filter_groups</code> function. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">filtered_ep &lt;-<span class="st"> </span><span class="kw"><a href="../reference/filter_groups.html">filter_groups</a></span>(end_point_info,
              <span class="dt">groupCol =</span> <span class="st">"intended_target_family"</span>,
              <span class="dt">assays =</span> <span class="kw">c</span>(<span class="st">"ATG"</span>,<span class="st">"NVS"</span>, <span class="st">"OT"</span>, <span class="st">"TOX21"</span>, 
                         <span class="st">"CEETOX"</span>, <span class="st">"APR"</span>, <span class="st">"CLD"</span>, <span class="st">"TANGUAY"</span>,
                         <span class="st">"NHEERL_PADILLA"</span>,<span class="st">"NCCT_SIMMONS"</span>, <span class="st">"ACEA"</span>),
              <span class="dt">remove_groups =</span> <span class="kw">c</span>(<span class="st">"Background Measurement"</span>,
                                <span class="st">"Undefined"</span>))</code></pre></div>
<p>What is happening here is that the supplied data frame <code>end_point_info</code> is filtered to just the “intended_target_family” group. Additionally, the assay BioSeek is removed (it is the only one not included in the possible list of assays). Finally, of all the groups within intended_target_family, the end points designated “Undefined” and “Background Measurement” are removed.</p>
</div>
<div id="summarize_data" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize_data" class="anchor"></a>Summarizing the data</h2>
<p>The functions in <code>toxEval</code> summarize the data as follows:</p>
<p>First, individual EAR values are calculated for each chemical:endPoint combination. Then, the EAR values are summed together by samples (a sample is defined as a unique site/date) based on the grouping picked in the “category” argument. Categories include “Biological”, “Chemical Class”, or “Chemical”. “Biological” refers to the chosen ToxCast annotation as defined in the <code>groupCol</code> argument of the <code>filter_groups</code> function. “Chemical Class” refers to the groupings of chemicals as defined in the “Class” column of the “Chemicals” sheet of the input file. “Chemical” refers to the individual chemical as defined by a unique CAS value. Finally, the maximum or mean EAR is calculated per site (based on the <code>mean_logic</code> option). This ensures that each site is represented equally regardless of how many samples are available per site.</p>
<p>Some functions will also include a calculation for a “hit”. A threshold is defined by the user, and if the mean or maximum EAR (calculated as described above) is greater than the threshold, that is considered a “hit”.</p>
</div>
</div>
<div id="package-logistics" class="section level1">
<h1 class="hasAnchor">
<a href="#package-logistics" class="anchor"></a>Package logistics</h1>
<div id="installation-of-r-and-rstudio" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-of-r-and-rstudio" class="anchor"></a>Installation of R and RStudio</h2>
<p>The following link provides instructions for installation of R and RStudio:</p>
<p><a href="https://owi.usgs.gov/R/training-curriculum/installr/">Installation Instructions</a></p>
<p>Following these instructions will add the USGS R repository (GRAN) the user’s R profile. For users who have previously installed R and RStudio, GRAN can be added the R profile by pasting the following into the R console:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rprofile_path =<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">Sys.getenv</span>(<span class="st">"HOME"</span>), <span class="st">".Rprofile"</span>)
<span class="kw">write</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">options(repos=c(getOption(</span><span class="ch">\'</span><span class="st">repos</span><span class="ch">\'</span><span class="st">),</span>
<span class="st">    CRAN=</span><span class="ch">\'</span><span class="st">https://cloud.r-project.org</span><span class="ch">\'</span><span class="st">,</span>
<span class="st">    USGS=</span><span class="ch">\'</span><span class="st">https://owi.usgs.gov/R</span><span class="ch">\'</span><span class="st">))</span><span class="ch">\n</span><span class="st">'</span>,
      rprofile_path, 
      <span class="dt">append =</span>  <span class="ot">TRUE</span>)

<span class="kw">cat</span>(<span class="st">'Your Rprofile has been updated to include GRAN.</span>
<span class="st">    Please restart R for changes to take effect.'</span>)</code></pre></div>
<p><em>RESTART RSTUDIO!</em></p>
<p>Useful links:</p>
<ul>
<li><a href="https://cran.r-project.org/bin/windows/base/">Download R Windows</a></li>
<li><a href="https://cran.r-project.org/bin/macosx/">Download R Mac</a></li>
<li><a href="https://www.rstudio.com/products/rstudio/download/">Download RStudio</a></li>
</ul>
</div>
<div id="installation-of-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-of-toxeval" class="anchor"></a>Installation of toxEval</h2>
<p>This section assumes GRAN was added to the R profile as described above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"toxEval"</span>)</code></pre></div>
</div>
<div id="update-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#update-toxeval" class="anchor"></a>Update toxEval</h2>
<p><img style="float: right;" src="update.png"></p>
<p>Regularly, it is a good idea to update <em>ALL</em> of installed packages in R. If using RStudio, this is done by using the Update button in the “Packages” tab in RStudio. Selecting this option checks CRAN and GRAN for updates.</p>
<p>Within the R-console, packages can be updated with the command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">update.packages</span>()</code></pre></div>
</div>
<div id="reporting-bugs" class="section level2">
<h2 class="hasAnchor">
<a href="#reporting-bugs" class="anchor"></a>Reporting bugs</h2>
<p>If you discover an issue that you feel is a bug in the package or have a question on functionality, please consider reporting bugs and asking questions on the Issues page: <a href="https://github.com/USGS-R/toxEval/issues" class="uri">https://github.com/USGS-R/toxEval/issues</a></p>
</div>
<div id="citing-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-toxeval" class="anchor"></a>Citing toxEval</h2>
<p>This package has not been reviewed and approved as a USGS-product. The implication is that <code>toxEval</code> cannot be cited in a publication. Once the software has been reviewed and approved, basic citation information will be available using the function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">citation</span>(<span class="dt">package =</span> <span class="st">"toxEval"</span>)</code></pre></div>
</div>
</div>
<div id="disclaimer" class="section level1">
<h1 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h1>
<p>This software has been approved for release by the U.S. Geological Survey (USGS). Although the software has been subjected to rigorous review, the USGS reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the USGS or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the USGS nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#what-is-toxcast">What is ToxCast?</a></li>
      <li><a href="#exposure-activity-ratio">Exposure-Activity Ratio</a></li>
      <li><a href="#what-is-an-endpoint">What is an “endPoint”?</a></li>
      <li><a href="#what-is-a-group">What is a “group”?</a></li>
      <li><a href="#summarize_data">Summarizing the data</a></li>
      </ul>
</li>
      <li>
<a href="#package-logistics">Package logistics</a><ul class="nav nav-pills nav-stacked">
<li><a href="#installation-of-r-and-rstudio">Installation of R and RStudio</a></li>
      <li><a href="#installation-of-toxeval">Installation of toxEval</a></li>
      <li><a href="#update-toxeval">Update toxEval</a></li>
      <li><a href="#reporting-bugs">Reporting bugs</a></li>
      <li><a href="#citing-toxeval">Citing toxEval</a></li>
      </ul>
</li>
      <li><a href="#disclaimer">Disclaimer</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laura DeCicco, Steven Corsi, Daniel Villeneuve, Brett Blackwell, Gerald Ankley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
