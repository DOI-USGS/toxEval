<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to toxEval • toxEval</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to toxEval">
<meta property="og:description" content="toxEval">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-53797708-7"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-53797708-7');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">toxEval</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Introduction.html">Background</a>
</li>
<li>
  <a href="../articles/basicWorkflow.html">Basic Workflow</a>
</li>
<li>
  <a href="../reference/index.html">Function Help</a>
</li>
<li>
  <a href="../articles/PrepareData.html">Data Preparation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/shinyApp.html">Shiny App</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Exploring Benchmarks</a>
    </li>
    <li>
      <a href="../articles/pivot.html">Prepare Data in R</a>
    </li>
    <li>
      <a href="../articles/does_curves.html">Dose Response Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/bibliography.html">Bibliograpy</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/USGS-R/toxEval">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to toxEval</h1>
            
            <h4 class="date">14 May, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/toxEval/blob/master/vignettes/Introduction.Rmd"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>toxEval</code> R-package includes a set of functions to analyze, visualize, and organize measured concentration data as it relates to <a href="https://www.epa.gov/chemical-research/toxicity-forecasting">ToxCast data</a> (default) or other user-selected chemical-biological interaction benchmark data such as water quality criteria. The intent of these analyses is to develop a better understanding of the potential biological relevance of environmental chemistry data. Results can be used to prioritize which chemicals at which sites may be of greatest concern. These methods are meant to be used as a screening technique to predict potential for biological influence from chemicals that ultimately need to be validated with direct biological assays.</p>
<p>The functions within this package allow great flexibly for exploring the potential biological affects of measured chemicals. Also included in the package is a browser-based application made from the <code>Shiny</code> R-package (the app). The app is based on functions within the R-package and includes many convenient analyses and visualization options for users to choose. Use of the functions within the R-package allows for additional flexibility within the functions beyond what the app offers and provides options for the user to interact more directly with the data. The overview in this document focuses on the R-package. Documentation for the app is provided in the <a href="shinyApp.html">ShinyApp vignette</a>.</p>
<p>This vignette provides a general overview of the concepts within <code>toxEval</code>, definitions of common terminology used throughout the package, and links to information to help understand fundamentals of the ToxCast database used within <code>toxEval</code>. In addition, instructions are provided for installing and updating the package from the Geological Survey R Archive Network (GRAN).</p>
<div id="what-is-toxcast" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-toxcast" class="anchor"></a>What is ToxCast?</h2>
<p>The U.S. EPA’s Toxicity Forecaster <a href="https://www.epa.gov/chemical-research/toxicity-forecasting" target="_blank">ToxCast</a> includes a database of chemical-biological interactions that contains information from hundreds of assays on thousands of chemicals, providing a means to assess biological relevance to measured concentrations. The <code>toxEval</code> package attempts to simplify the workflow for exploring data as it relates to these assay endpoints (benchmark data). The workflow uses ToxCast as a default for evaluation of chemical:biological interactions, but the user may also define alternative benchmarks for a custom or more traditional approach to biological relevance evaluation. This is also a useful capability for efficient comparison of ToxCast evaluation results with those from other toxicity benchmark databases.</p>
<p>When using the ToxCast endPoints for analysis, it is important to have at least a minimal understanding of what ToxCast data is, and which ToxCast data is relevant to any given study. There are many useful resources <a href="https://www.epa.gov/chemical-research/toxicity-forecasting" target="_blank">here</a>. There is also a tool called the <a href="https://comptox.epa.gov/dashboard/" target="_blank">Comptox Dashboard</a> that has a wealth of information on ToxCast data.</p>
<p>So what are we doing with the user input data and ToxCast? First, we calculate an Exposure-Activity Ratio (EAR) for each measurement. Then we can explore the EARs based on a wide variety of groupings to view the data in many dimensions.</p>
</div>
<div id="exposure-activity-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#exposure-activity-ratio" class="anchor"></a>Exposure-Activity Ratio</h2>
<p>An Exposure-Activity Ratio (EAR) is defined as the ratio of a measured concentration and a concentration that was determined to cause some activity in a specified ToxCast assay (“endPoint” concentration). An EAR &gt; 1.0 would indicate that the measured concentration is greater than the endpoint concentration. The ToxCast database (as provided in the current version of <code>toxEval</code>) provides as many as several hundred endPoints for more than 7000 chemicals. Each endPoint is a single test that was done to detect some form of biological activity.</p>
<p>In order to get appropriate EAR results, it is important to use the correct units. The <code>toxEval</code> package assumes all measured concentrations are reported in micrograms per liter (<span class="math inline">\(\mu\)</span>g/L). ToxCast data is reported in log(<span class="math inline">\(\mu\)</span>M), so the <code>toxEval</code> package automatically performs the unit conversion.</p>
<p>A secondary option within <code>toxEval</code> is for the user to provide a set of “benchmark concentrations” to define custom biological responses to meet specific study objectives (e.g. water quality criteria). In this case, EAR values are replaced with toxicity quotients. Similar to EAR values, toxicity quotients are defined as the ratio of a measured concentration to the benchmark concentration.</p>
<p>EAR is basically synonymous with bioanalytical equivalent concentrations (BEQ). EAR is a ratio, and BEQ is a measure of concentration, but both convey the same information.</p>
</div>
<div id="what-is-an-endpoint" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-an-endpoint" class="anchor"></a>What is an “endPoint”?</h2>
<p>ToxCast uses high-throughput assays to create concentration-response curves for each of these chemical:endPoint combinations. An endPoint is “associated with the perturbation of specific biological processes identified for the confirmation or monitoring of predicted site-specific hazards” <a href="https://doi.org/10.1021/acs.est.7b01613" target="_blank">Blackwell 2017</a>. That means a specific biological action was tested, and the concentration at which activity was observed was determined. Of several endpoint values provided within the ToxCast database, the activity concentration at cutoff (ACC) was chosen to compute EAR values within the <code>toxEval</code> package, consistent with the description in <a href="https://doi.org/10.1021/acs.est.7b01613" target="_blank">Blackwell, 2017</a>. ACC values from the ToxCast database are provided within the <code>toxEval</code> package.</p>
</div>
<div id="what-is-a-group" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-a-group" class="anchor"></a>What is a “group”?</h2>
<p>Often, it is valuable to consider aggregations of single endPoints in evaluation efforts. ToxCast has provided tables that group individual endPoints into generalized categories for functional use. The grouping summary table is included in <code>toxEval</code> and can be explored via the <code>end_point_info</code> data:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">toxEval</span>)
<span class="no">end_point_info</span> <span class="kw">&lt;-</span> <span class="no">end_point_info</span></pre></body></html></div>
<p>See the help file <code><a href="../reference/end_point_info.html">?end_point_info</a></code> for specifics on how the table was downloaded.</p>
<p>Throughout the <code>toxEval</code> analysis, there are graphing and table functions that will summarize EARs based on either “Biological” groupings (as defined by a group of endPoints) or “Chemical Class” groupings (as defined by a group of chemicals).</p>
<p>The default grouping of ToxCast endPoints is “intended_target_family”, but depending on the analysis, it may be more appropriate to use other grouping categories. To change the default, specify a grouping in the <code>groupCol</code> argument of the <code>filter_groups</code> function. For example:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">filtered_ep</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/filter_groups.html">filter_groups</a></span>(<span class="no">end_point_info</span>,
              <span class="kw">groupCol</span> <span class="kw">=</span> <span class="st">"intended_target_family"</span>,
              <span class="kw">assays</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ATG"</span>,<span class="st">"NVS"</span>, <span class="st">"OT"</span>, <span class="st">"TOX21"</span>,
                         <span class="st">"CEETOX"</span>, <span class="st">"APR"</span>, <span class="st">"CLD"</span>, <span class="st">"TANGUAY"</span>,
                         <span class="st">"NHEERL_PADILLA"</span>,<span class="st">"NCCT_SIMMONS"</span>, <span class="st">"ACEA"</span>),
              <span class="kw">remove_groups</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Background Measurement"</span>,
                                <span class="st">"Undefined"</span>))</pre></body></html></div>
<p>What is happening here is that the supplied data frame <code>end_point_info</code> is filtered to just the “intended_target_family” group. Additionally, the assay BioSeek is removed (it is the only one not included in the possible list of assays). Finally, of all the groups within intended_target_family, the end points designated “Undefined” and “Background Measurement” are removed.</p>
</div>
<div id="summarize_data" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize_data" class="anchor"></a>Summarizing the data</h2>
<p>The functions in <code>toxEval</code> summarize the data as follows:</p>
<p>First, individual EAR values are calculated for each chemical:endPoint combination. Then, the EAR values are summed together by samples (a sample is defined as a unique site/date) based on the grouping picked in the “category” argument. Categories include “Biological”, “Chemical Class”, or “Chemical”. “Biological” refers to the chosen ToxCast annotation as defined in the <code>groupCol</code> argument of the <code>filter_groups</code> function. “Chemical Class” refers to the groupings of chemicals as defined in the “Class” column of the “Chemicals” sheet of the input file. “Chemical” refers to the individual chemical as defined by a unique CAS value. Finally, the maximum or mean EAR is calculated per site (based on the <code>mean_logic</code> option). This ensures that each site is represented equally regardless of how many samples are available per site.</p>
<p>Some functions will also include a calculation for a “hit”. A threshold is defined by the user, and if the mean or maximum EAR (calculated as described above) is greater than the threshold, that is considered a “hit”.</p>
</div>
</div>
<div id="package-logistics" class="section level1">
<h1 class="hasAnchor">
<a href="#package-logistics" class="anchor"></a>Package logistics</h1>
<div id="installation-of-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-of-toxeval" class="anchor"></a>Installation of toxEval</h2>
<p><code>toxEval</code> is available on any CRAN mirror.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"toxEval"</span>)</pre></body></html></div>
</div>
<div id="update-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#update-toxeval" class="anchor"></a>Update toxEval</h2>
<p><code>toxEval</code> does require a fair number of additional packages to run properly. These dependencies offer many benefits, such as a smooth running intuitive Shiny app. The drawbacks however are that there becomes more risk that those dependencies could change their output/workflow over time. <code>toxEval</code> developers will try to stay on top of those changes, but it is a challenge. It is important to always update <em>all</em> of your packages therefore…..not just <code>toxEval</code>. <code>toxEval</code> may push out a new version to keep up with a critical change in a dependent package, and if you only update <code>toxEval</code>, the update could cause bugs (we will attempt to mandate the package version of each package, but it still is best to stay on top of new package versions).</p>
<p><img src="update.png" width="144"></p>
<p>Regularly, it is a good idea to update <em>ALL</em> of installed packages in R. If using RStudio, this is done by using the Update button in the “Packages” tab in RStudio. Selecting this option checks CRAN for updates. Within the R-console, packages can be updated with the command:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/update.packages.html">update.packages</a></span>()</pre></body></html></div>
</div>
<div id="reporting-bugs" class="section level2">
<h2 class="hasAnchor">
<a href="#reporting-bugs" class="anchor"></a>Reporting bugs</h2>
<p>If you discover an issue that you feel is a bug in the package or have a question on functionality, please consider reporting bugs and asking questions on the Issues page: <a href="https://github.com/USGS-R/toxEval/issues">https://github.com/USGS-R/toxEval/issues</a></p>
</div>
<div id="citing-toxeval" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-toxeval" class="anchor"></a>Citing toxEval</h2>
<p>This package has not been reviewed and approved as a USGS-product. The implication is that <code>toxEval</code> cannot be cited in a publication. Once the software has been reviewed and approved, basic citation information will be available using the function:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span>(<span class="kw">package</span> <span class="kw">=</span> <span class="st">"toxEval"</span>)</pre></body></html></div>
<pre><code>## 
## To cite toxEval in publications, please use:
## 
##   De Cicco, L.A., Corsi, S.R., Villeneuve D.L, Blackwell, and B.R,
##   Ankley, G.T., 2018, toxEval: Evaluation of measured concentration
##   data using the ToxCast high-throughput screening database or a
##   user-defined set of concentration benchmarks. R package version
##   1.1.0., https://code.usgs.gov/water/toxEval, doi:10.5066/P906UQ5I
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     author = {Laura A. {De Cicco} and Steven R. Corsi and Daniel L. Villeneuve and Brett R. Blackwell and Gerald T. Ankley},
##     title = {toxEval: Evaluation of measured concentration data using the ToxCast high-throughput screening database or a user-defined set of concentration benchmarks.},
##     publisher = {U.S. Geological Survey},
##     version = {1.1.0},
##     address = {Reston, VA},
##     institution = {U.S. Geological Survey},
##     year = {2019},
##     doi = {10.5066/P906UQ5I},
##     url = {https://code.usgs.gov/water/toxEval},
##   }</code></pre>
</div>
</div>
<div id="disclaimer" class="section level1">
<h1 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h1>
<p>This software has been approved for release by the U.S. Geological Survey (USGS). Although the software has been subjected to rigorous review, the USGS reserves the right to update the software as needed pursuant to further analysis and review. No warranty, expressed or implied, is made by the USGS or the U.S. Government as to the functionality of the software and related material nor shall the fact of release constitute any such warranty. Furthermore, the software is released on condition that neither the USGS nor the U.S. Government shall be held liable for any damages resulting from its authorized or unauthorized use.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Laura DeCicco, Steven Corsi, Daniel Villeneuve, Brett Blackwell, Gerald Ankley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
